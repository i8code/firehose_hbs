<div>
  <ul id="showall" class="nav nav-pills" style="float:right; margin: 10px; width: 42%;">
    <li class="active"><%= link_to 'Show all', map_map_path%> </li>
  </ul>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<title>NYC Adventure Map</title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
<meta charset="utf-8">

<script type='text/javascript'>

(function()
{
  if( window.localStorage )
  {
    if( !localStorage.getItem( 'firstLoad' ) )
    {
      localStorage[ 'firstLoad' ] = true;
      window.location.reload();
    }  
    else
      localStorage.removeItem( 'firstLoad' );
  }
})();

</script>

<script src="//maps.google.com/maps?file=api&amp;v=2&amp;key=AIzaSyCPLbu8YjZRwomPf5PC6rIEwAuv57GfR5E"
type="text/javascript"></script>

<script type="text/javascript">
//$(function() {
$(window).load(function  () {


//$(document).ready(function() {
  $( window ).unload(function() {
    GUnload();
  });
  //load window first 
  // $(window).load(function)(){ 
      //if (GBrowserIsCompatible()) {
  //function initialize() {
    if (GBrowserIsCompatible()) {
        var map = new GMap2(document.getElementById("map_canvas"));
        // center of map at central park, zoom
        map.setCenter(new GLatLng(40.77464310, -73.97019620), 13);
        //map.setCenter(new GLatLng(@pic.lat, @pic.lat), 13);
        //var map = new GMap2(document.getElementById("map_canvas"));
        $("section").each(function() {
          //take the lat and lng from the rails below, split it into an array using the | 
          var encoded_lat_lng = $(this).html();
          var array_version = encoded_lat_lng.split("|");
          var lat = array_version[0];
          var lng = array_version[1];
          var place = array_version[2];
          var point = new GLatLng(lat, lng);
          //var marker = 
          map.addOverlay(new GMarker(point, {title: 'hi'}));
        
           //map.addMarker(new MarkerOptions().position(point)
                //.title(place));

          console.log(place)
          //var title = loc; 
          // marker.setTitle(place); 

        });
        // map.setCenter(new GLatLng(@picsNearby.lat, @picsNearby.lng), 13);
    }
  //}
});

</script>

<!--<div onload="initialize()" onunload="GUnload()">-->
  <div id="left">
    <div style="height:100%; width:100%;">

      <!--Map style on Webpage-->
      <div id="map_canvas" style="width: 500px; height: 1000px; margin: 10px; margin-top: 50px; width: 50%; position: fixed !important; top: 0;">
      </div>
    </div>
  </div>

  <!--Side recs on webpage
  <div class="span4 boxy text-center" style="float:right; margin: 10px; width: 42%"> 
  New York Recs here
  <br/>
  <br/>
  Im a rocking place
  <br/>
  <br/>
  and so am I 
  <br/>
  <br/>
  and me too -->
<div class="right-contain">
  <div id="right">
    <div id="one" class="hidden">
      <div class="span4 boxy text-center">
        <h2>
          <%= @pic.place %>
        </h2>
        <%= @pic.location %>
        <section >
          <%= @pic.lat.to_s + "|" + @pic.lng.to_s %>
        </section>
      </div>
    </div>


    <div id="nearby" >
      <% @picsNearby.each do |pic| %>
      <div class="span4 boxy text-center">
        <h2>
          <%= pic.place %>
        </h2>
        <%= pic.location %>
        <section >
          <%= pic.lat.to_s + "|" + pic.lng.to_s + "|" + pic.place %>
        </section>
      </div>
      <% end %> 
    </div>
  </div>
</div> <!-- right contain -->

<!--<div id="map-canvas"></div>-->

<!--</div>-->
